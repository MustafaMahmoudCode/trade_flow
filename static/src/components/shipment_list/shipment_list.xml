<?xml version="1.0" encoding="UTF-8" ?>
<templates xml:space="preserve">

    <t t-name="trade_flow.ShipmentList">
        <div class="ship-list-container">

            <!-- Header -->
            <div class="row mx-2 mt-3">
                <!-- New Shipment Button -->
                <div class="col-lg-6">
                    <button class="btn btn-primary"
                            data-bs-toggle="modal"
                            data-bs-target="#exampleModal"
                            t-on-click="addShipment">
                        New
                    </button>
                </div>

                <!-- Search Box -->
                <div class="col-lg-3">
                    <div class="input-group">
                        <input type="text"
                               class="form-control"
                               t-ref="search-input"
                               t-on-keyup="searchShipment"
                               placeholder="Search shipments..."/>
                        <button class="btn btn-outline-primary"
                                t-on-click="searchShipment">
                            Search
                        </button>
                    </div>
                </div>
            </div>

            <!-- Shipments Table -->
            <div class="row m-2">
                <div class="col">
                    <table class="table table-striped table-hover border">
                        <thead>
                            <tr>
                                <th>Weight (kg)</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Client</th>
                                <th>Handled By</th>
                                <th>Reference</th>
                                <th>Actions</th>
                            </tr>
                        </thead>

                        <tbody t-foreach="state.shipments"
                               t-as="shipment"
                               t-key="shipment.id">
                            <tr>
                                <td><t t-esc="shipment.weight"/></td>
                                <td><t t-esc="shipment.shipment_type"/></td>
                                <td><t t-esc="shipment.state"/></td>
                                <td><t t-esc="shipment.client_name"/></td>
                                <td><t t-esc="shipment.employee_name"/></td>
                                <td><t t-esc="shipment.name"/></td>
                                <td>
                                    <button class="btn btn-success me-2"
                                            data-bs-toggle="modal"
                                            data-bs-target="#exampleModal"
                                            t-on-click="() => this.editShipment(shipment)">
                                        Edit
                                    </button>
                                    <button class="btn btn-danger"
                                            t-on-click="() => this.deleteShipment(shipment)">
                                        Delete
                                    </button>
                                </td>
                            </tr>
                        </tbody>

                    </table>
                </div>
            </div>

            <!-- Add / Edit Shipment Modal -->
            <div class="modal fade" id="exampleModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content">

                        <div class="modal-header">
                            <h5 class="modal-title">Add / Edit Shipment</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>

                        <div class="modal-body">

                            <!-- Weight -->
                            <div class="mb-3">
                                <label class="form-label">Weight (kg)</label>
                                <input type="number"
                                       class="form-control"
                                       t-model="state.shipmentForm.weight"/>
                            </div>

                            <!-- Shipment Type -->
                            <div class="mb-3">
                                <label class="form-label">Type</label>
                                <select class="form-select"
                                        t-model="state.shipmentForm.shipment_type">
                                    <option value="standard">Standard</option>
                                    <option value="express">Express</option>
                                </select>
                            </div>

                            <!-- Status -->
                            <div class="mb-3">
                                <label class="form-label">Status</label>
                                <select class="form-select"
                                        t-model="state.shipmentForm.state">
                                    <option value="pending">Pending</option>
                                    <option value="in_transit">In Transit</option>
                                    <option value="delivered">Delivered</option>
                                    <option value="cancel">Cancelled</option>
                                </select>
                            </div>

                            <!-- Client -->
                            <div class="mb-3">
                                <label class="form-label">Client</label>
                                <select class="form-select"
                                        t-model="state.shipmentForm.client_id">
                                    <option value="">Select Client</option>
                                    <option t-foreach="state.clients"
                                            t-as="c"
                                            t-key="c.id"
                                            t-att-value="c.id">
                                        <t t-esc="c.name"/>
                                    </option>
                                </select>
                            </div>

                            <!-- Employee -->
                            <div class="mb-3">
                                <label class="form-label">Handled By</label>
                                <select class="form-select"
                                        t-model="state.shipmentForm.employee_id">
                                    <option value="">Select Employee</option>
                                    <option t-foreach="state.employees"
                                            t-as="e"
                                            t-key="e.id"
                                            t-att-value="e.id">
                                        <t t-esc="e.name"/>
                                    </option>
                                </select>
                            </div>

                            <!-- Reference -->
                            <div class="mb-3">
                                <label class="form-label">Reference</label>
                                <input type="text"
                                       class="form-control"
                                       t-model="state.shipmentForm.name"/>
                            </div>

                        </div>

                        <div class="modal-footer">
                            <button class="btn btn-secondary"
                                    data-bs-dismiss="modal">
                                Close
                            </button>
                            <button class="btn btn-primary"
                                    t-on-click="saveShipment">
                                Save
                            </button>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </t>
</templates>
